---
title: "Cumulative"
author: "Umaira"
format: html
execute: 
  echo: false
---


```{r}
#| message: false
#| warning: false
library(MASS)
library(tidyverse)
library(primer.data)
library(broom)
library(tidymodels)
library(easystats)
library(marginaleffects )

```

```{r}
#| message: false
#| warning: false
x <- ces |>
  filter(year == 2020) |>
  select(approval, ideology, education) |>
  drop_na() |> 
  filter(! ideology %in% "Not Sure") |> 
  mutate(ideology = fct_drop(ideology))
```
```{r}
#| cache : true 
fit_approval <- polr(approval ~ ideology + education,
                      data = x)
```

```{r}
fit_approval |>
    tidy(conf.int = TRUE)

```


```{r}
x |> 
  ggplot(aes(x = ideology, fill = approval)) +
  geom_bar() +
  labs(
    title = "Presidential Approval by Ideology (2020)",
    subtitle = "Approval levels vary strongly with political ideology",
    x = "Political Ideology",
    y = "Number of Respondents",
    fill = "Presidential Approval",
    caption = "Source: CES 2020 Data"
  )

```

```{r}
library(gt)

# Tidy the model and make a clean table
fit_approval |>
  tidy(conf.int = TRUE) |>
  select(term, estimate, conf.low, conf.high) |>
  gt() |>
  tab_header(
    title = "Model Estimates for Presidential Approval",
    subtitle = "Cumulative Logit Model with Ideology and Education"
  ) |>
  fmt_number(
    columns = c(estimate, conf.low, conf.high),
    decimals = 2
  ) |>
  cols_label(
    term = "Term",
    estimate = "Estimate",
    conf.low = "95% CI (Low)",
    conf.high = "95% CI (High)"
  )

```

```{r}
#| label: fig-approval-ideology-education
#| fig-cap: "Predicted Presidential Approval by Ideology and Education"
#| warning: false
#| message: false

library(ggplot2)
library(marginaleffects)

plot_predictions(fit_approval, 
                 condition = c("ideology", "education")) +
  labs(
    title = "Presidential Approval by Ideology and Education",
    subtitle = "Approval is highest among very conservative and highly educated individuals",
    x = "Ideology",
    y = "Predicted Probability of Approval",
    caption = "Data Source: 2020 Cooperative Election Study (CES)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 13),
    plot.caption = element_text(size = 10),
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom"
  )

```

People’s opinions of political leaders often vary based on personal characteristics like ideology and education. Using data from the 2020 Cooperative Election Study, which surveyed tens of thousands of U.S. adults, we examine how presidential approval differs across ideology groups.One potential weakness of our model is that the approval data is self-reported, which may introduce bias if respondents misrepresent their true opinions due to social desirability or other unmeasured factors. We model presidential approval as an ordinal function of ideological identification and education using a cumulative logit model, which estimates the probability of respondents falling into different levels of approval based on these covariates. On average, individuals who identify as Very Conservative are 74 percentage points more likely to Strongly Approve of the president compared to those who identify as Very Liberal, with an estimated difference of 0.74 and a margin of uncertainty of approximately ±0.02.

$$P(Y \leq k) = \frac{1}{1 + e^{-(\alpha_k - \beta_1 \cdot \text{ideology} - \beta_2 \cdot \text{education})}}$$

with $Y \sim \text{Ordinal}(\boldsymbol{\rho})$ where $\boldsymbol{\rho} = (\rho_1, \rho_2, \ldots, \rho_K)$ are derived from the cumulative probabilities above.

This is our data generating mechanism.


$$\begin{aligned}
\log\left[ \frac { P( \operatorname{approval}  \leq  \operatorname{Strongly\ Disapprove} ) }{ 1 - P( \operatorname{approval}  \leq  \operatorname{Strongly\ Disapprove} ) } \right] &= 2.26 + 0.61(\operatorname{ideology}_{\operatorname{Liberal}}) + 2.4(\operatorname{ideology}_{\operatorname{Moderate}}) + 4.46(\operatorname{ideology}_{\operatorname{Conservative}}) + 5.45(\operatorname{ideology}_{\operatorname{Very\ Conservative}}) - 0.1(\operatorname{education}_{\operatorname{High\ School\ Graduate}}) - 0.31(\operatorname{education}_{\operatorname{Some\ College}}) - 0.32(\operatorname{education}_{\operatorname{2-Year}}) - 0.52(\operatorname{education}_{\operatorname{4-Year}}) - 0.73(\operatorname{education}_{\operatorname{Post-Grad}}) \\
\log\left[ \frac { P( \operatorname{approval}  \leq  \operatorname{Disapprove\ /\ Somewhat\ Disapprove} ) }{ 1 - P( \operatorname{approval}  \leq  \operatorname{Disapprove\ /\ Somewhat\ Disapprove} ) } \right] &= 2.73 + 0.61(\operatorname{ideology}_{\operatorname{Liberal}}) + 2.4(\operatorname{ideology}_{\operatorname{Moderate}}) + 4.46(\operatorname{ideology}_{\operatorname{Conservative}}) + 5.45(\operatorname{ideology}_{\operatorname{Very\ Conservative}}) - 0.1(\operatorname{education}_{\operatorname{High\ School\ Graduate}}) - 0.31(\operatorname{education}_{\operatorname{Some\ College}}) - 0.32(\operatorname{education}_{\operatorname{2-Year}}) - 0.52(\operatorname{education}_{\operatorname{4-Year}}) - 0.73(\operatorname{education}_{\operatorname{Post-Grad}}) \\
\log\left[ \frac { P( \operatorname{approval}  \leq  \operatorname{Neither\ Approve\ nor\ Disapprove} ) }{ 1 - P( \operatorname{approval}  \leq  \operatorname{Neither\ Approve\ nor\ Disapprove} ) } \right] &= 2.82 + 0.61(\operatorname{ideology}_{\operatorname{Liberal}}) + 2.4(\operatorname{ideology}_{\operatorname{Moderate}}) + 4.46(\operatorname{ideology}_{\operatorname{Conservative}}) + 5.45(\operatorname{ideology}_{\operatorname{Very\ Conservative}}) - 0.1(\operatorname{education}_{\operatorname{High\ School\ Graduate}}) - 0.31(\operatorname{education}_{\operatorname{Some\ College}}) - 0.32(\operatorname{education}_{\operatorname{2-Year}}) - 0.52(\operatorname{education}_{\operatorname{4-Year}}) - 0.73(\operatorname{education}_{\operatorname{Post-Grad}}) \\
\log\left[ \frac { P( \operatorname{approval}  \leq  \operatorname{Approve\ /\ Somewhat\ Approve} ) }{ 1 - P( \operatorname{approval}  \leq  \operatorname{Approve\ /\ Somewhat\ Approve} ) } \right] &= 3.93 + 0.61(\operatorname{ideology}_{\operatorname{Liberal}}) + 2.4(\operatorname{ideology}_{\operatorname{Moderate}}) + 4.46(\operatorname{ideology}_{\operatorname{Conservative}}) + 5.45(\operatorname{ideology}_{\operatorname{Very\ Conservative}}) - 0.1(\operatorname{education}_{\operatorname{High\ School\ Graduate}}) - 0.31(\operatorname{education}_{\operatorname{Some\ College}}) - 0.32(\operatorname{education}_{\operatorname{2-Year}}) - 0.52(\operatorname{education}_{\operatorname{4-Year}}) - 0.73(\operatorname{education}_{\operatorname{Post-Grad}})
\end{aligned}$$

